<Window x:Class="CodeDup.App.Views.DuplicateCodeAnalysisWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="重复代码分析" Height="700" Width="1200"
        WindowStartupLocation="CenterOwner">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- 参数设置 -->
        <GroupBox Header="分析参数" Grid.Row="0" Margin="10">
            <StackPanel Orientation="Horizontal" Margin="10">
                <TextBlock Text="最小重复次数：" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox x:Name="MinOccurrencesBox" Width="60" Text="3" VerticalAlignment="Center"/>
                <TextBlock Text="（出现在多少个不同文件中）" VerticalAlignment="Center" Margin="10,0,20,0" Foreground="Gray"/>
                
                <TextBlock Text="最小代码行数：" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <TextBox x:Name="MinLineCountBox" Width="60" Text="3" VerticalAlignment="Center"/>
                <TextBlock Text="（连续多少行视为一个片段）" VerticalAlignment="Center" Margin="10,0,20,0" Foreground="Gray"/>
                
                <Button Content="开始分析" Click="Analyze_Click" Padding="15,5"/>
            </StackPanel>
        </GroupBox>
        
        <!-- 统计信息 -->
        <GroupBox Header="分析结果" Grid.Row="1" Margin="10,0,10,10">
            <StackPanel Orientation="Horizontal" Margin="10">
                <TextBlock x:Name="StatsText" Text="等待分析..." FontSize="14"/>
            </StackPanel>
        </GroupBox>
        
        <!-- 主内容区域：左右分栏 -->
        <Grid Grid.Row="2" Margin="10,0,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- 左侧：重复代码列表 -->
            <GroupBox Header="重复代码片段" Grid.Column="0">
                <ListView x:Name="FragmentList">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="重复次数" Width="80" DisplayMemberBinding="{Binding OccurrenceCount}"/>
                            <GridViewColumn Header="行数" Width="60" DisplayMemberBinding="{Binding LineCount}"/>
                            <GridViewColumn Header="代码预览" Width="350" DisplayMemberBinding="{Binding PreviewText}"/>
                        </GridView>
                    </ListView.View>
                </ListView>
            </GroupBox>
            
            <!-- 分隔符 -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="#E0E0E0"/>
            
            <!-- 右侧：AI 分析报告 -->
            <GroupBox Header="AI 分析报告" Grid.Column="2">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Button x:Name="GenerateReportButton" 
                            Content="生成 AI 分析报告（前 10 个片段）" 
                            Click="GenerateReport_Click" 
                            Padding="10,5" 
                            Margin="5"
                            Grid.Row="0"/>
                    
                    <RichTextBox x:Name="AiReportBox" 
                                 Grid.Row="1"
                                 Margin="5"
                                 IsReadOnly="True" 
                                 VerticalScrollBarVisibility="Auto"
                                 HorizontalScrollBarVisibility="Auto"
                                 FontFamily="Microsoft YaHei"
                                 FontSize="13"
                                 Padding="10"
                                 Background="#F5F5F5">
                        <FlowDocument>
                            <Paragraph>
                                <Run Text="点击上方按钮生成 AI 分析报告..."/>
                            </Paragraph>
                        </FlowDocument>
                    </RichTextBox>
                </Grid>
            </GroupBox>
        </Grid>
    </Grid>
</Window>
